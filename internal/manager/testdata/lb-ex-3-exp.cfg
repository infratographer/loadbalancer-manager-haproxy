global
  master-worker
  maxconn 200
  pidfile /var/run/haproxy/haproxy.pid
  stats socket /var/run/haproxy/haproxy.sock mode 660 level admin expose-fd listeners
  log 127.0.0.1 local0

defaults unnamed_defaults_1
  mode tcp
  log global
  option tcplog
  timeout connect 5s
  timeout client 50s
  timeout server 50s
  retries 3

frontend http
  bind ipv4@:80
  use_backend http

frontend https
  bind ipv4@:443
  use_backend https

frontend stats
  mode http
  bind 127.0.0.1:29782
  stats enable
  stats uri /stats
  stats refresh 10s
  http-request use-service prometheus-exporter if { path /metrics }

backend http
  server svr1 3.1.4.1:80 check port 80

backend https
  server svr1 3.1.4.1:443 check port 443

program dataplaneapi
  command dataplaneapi -f /bitnami/haproxy/conf/dataplaneapi.cfg
  no option start-on-reload
